<div id="bindfit-index" class="container-fluid">
<!-- 
<div class="row">
    <div class="col-xs-24 col-md-8 col-md-offset-8">
        <div class="alert alert-default alert-dismissable" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4>Get started</h4>
            <ol>
                <li>Select a model to fit your data to</li>
                <li>Upload csv formatted data file</li>
                <li>Enter initial parameter guesses</li>
                <li>Click "Fit"</li>
            </ol>
        </div>
    </div>
</div>
-->

<div class="row">

    <div id="sidebar" class="col-xs-24 col-md-10 col-lg-8">

    <ul class="nav nav-tabs">
        <li class="nav active"><a href="#tab-control" data-toggle="tab">Control</a></li>
        <li class="nav"><a href="#tab-results" data-toggle="tab">Results</a></li>
        <li class="nav"><a href="#tab-save"    data-toggle="tab">Save</a></li>
    </ul>

    <div class="tab-content">
        <div class="tab-pane fade in active" id="tab-control">
        <div class="panel panel-default">
        <div class="panel-body">

            <form class="form-horizontal">
                <div class="form-group">
                    <div class="col-xs-24">
                        {{#x-select action="onFitterSelect" class="form-control"}}
                            <option>Choose fitter</option>
                            {{#each model.fitList as |fitter|}}
                                {{#x-option value=fitter.key}}{{fitter.name}}{{/x-option}}
                            {{/each}}
                        {{/x-select}}
                    </div>
                </div>
            </form>

            {{#if model.fitOptions.isPopulated}}
                <form class="form-horizontal" {{action "runFitter" on="enter"}}>
                    <div class="form-group">
                        <div class="col-xs-24">
                            {{data-file-upload onComplete="onUploadComplete" onRestart="onUploadRestart"}}
                        </div>

                        {{#each optionsParamsLabelled as |param|}}
                            <div class="input-group">
                                <div class="input-group-addon">{{param.label}} guess</div>
                                {{input value=param.value type="number" class="form-control"}}
                                <div class="input-group-addon">{{param.units}}</div>
                            </div>
                        {{/each}}

                    </div>
                    <div class="checkbox">
                        <label>
                            <div class="input-group col-xs-24">
                                {{input checked=model.fitOptions.options.dilute type="checkbox"}} Correct for dilution (if applicable) 
                            </div>
                        </label>
                    </div>
                </form>

                <hr/>
                {{async-button action="runFitter" default="Fit" pending="Fitting..." fulfilled="Recalculate fit" rejected="Fit failed" id="fit-button"}}
            {{/if}}

        </div> <!-- .panel-body -->
        </div> <!-- .panel -->
        </div> <!-- #tab-control -->

        <div class="tab-pane fade" id="tab-results">
        <div class="panel panel-default">
        <div class="panel-body">
        
            {{#if model.fitResult.isPopulated}}
                {{fit-result-table fitResult=model.fitResult fitLabels=model.fitLabels}}
            {{else}}
                <div class="panel-body">
                    <p>Fitted parameters will be displayed here once you've run a fitter in the Control tab.</p>
                </div>
            {{/if}}

        </div> <!-- .panel-body -->
        </div> <!-- .panel -->
        </div> <!-- #tab-results -->

        <div class="tab-pane fade" id="tab-save">
        <div class="panel panel-default">
        <div class="panel-body">

            {{#if model.fitResult.isPopulated}}
                <div class="panel-body">
                    <!-- Save form -->
                    {{fit-save fit=model.fitResult output=model.fitSave}}

                    <hr/>

                    <!-- Export button -->
                    {{fit-export fit=model.fitResult output=model.fitExport}}
                </div> <!-- Panel body -->
            {{else}}
                    <div class="panel-body">
                        <p>Run a fitter in the Control tab first.</p>
                    </div>
            {{/if}}

        </div> <!-- .panel-body -->
        </div> <!-- .panel -->
        </div> <!-- #tab-save -->
    </div> <!-- .tab-content -->

    </div> <!-- Sidebar -->



    <div id="main" class="col-xs-24 col-md-14 col-lg-16">
        <div class="row">
            <div class="col-xs-24">
                {{fit-charts fitResult=model.fitResult fitLabels=model.fitLabels}}
            </div> <!-- col -->
        </div> <!-- row -->

    </div> <!-- Main -->

</div> <!-- global row -->
</div> <!-- container -->
